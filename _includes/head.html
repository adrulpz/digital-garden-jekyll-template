<head>
  <meta charset="UTF-8">
<link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ "/feed.xml" | prepend: site.baseurl }}">

  <link rel="canonical" href="{{ site.url }}{{ page.url }}" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.title }}{% endif %}">

  <meta property="og:site_name" content="{{ site.title }}">

  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">

  <link rel="stylesheet" href="{{ site.baseurl }}/styles.css">

  {% if page.excerpt %}
  <meta property="og:description" content="{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}"/>
  {% else %}
  <meta property="og:description" content="{{ site.title | strip_html | strip_newlines | truncate: 160 }}"/>
  {% endif %}

  {% if page.title %}
  <meta property="og:title" content="{{ page.title }}">
  <meta property="og:type" content="article">
  {% else %}
  <meta property="og:title" content="{{ site.title }}">
  <meta property="og:type" content="website">
  {% endif %}

  {% if page.date %}
  <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
  <meta property="article:author" content="{{ site.url }}/">
  {% endif %}

  <meta property="og:url" content="{{ site.url }}{{ page.url }}" />

  {% if page.image %}
  <meta property="og:image" content="{{ site.url }}{{ page.image }}">
  {% endif %}

  <title>
    {% if page.id == "home" %}
      {{ site.title }}
    {% else %}
      {{ page.title }} &mdash; {{ site.title }}
    {% endif %}
  </title>

  <script>
    // Theme switching functionality
    document.addEventListener('DOMContentLoaded', function() {
      const themeToggle = document.getElementById('theme-toggle');
      const themeIcon = document.getElementById('theme-icon');
      
      if (!themeToggle || !themeIcon) {
        console.error('Theme toggle elements not found');
        return;
      }
      
      // Check for saved theme preference or default to system preference
      const getTheme = () => {
        const saved = localStorage.getItem('theme');
        if (saved) {
          return saved;
        }
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      };
      
      // Disable tooltips in dark mode
      const disableTooltips = () => {
        const elements = document.querySelectorAll('[title], [alt]');
        elements.forEach(el => {
          if (el.hasAttribute('title')) {
            el.setAttribute('data-original-title', el.getAttribute('title'));
            el.removeAttribute('title');
          }
          if (el.hasAttribute('alt')) {
            el.setAttribute('data-original-alt', el.getAttribute('alt'));
            el.removeAttribute('alt');
          }
        });
      };
      
      // Enable tooltips in light mode
      const enableTooltips = () => {
        const elements = document.querySelectorAll('[data-original-title], [data-original-alt]');
        elements.forEach(el => {
          if (el.hasAttribute('data-original-title')) {
            el.setAttribute('title', el.getAttribute('data-original-title'));
            el.removeAttribute('data-original-title');
          }
          if (el.hasAttribute('data-original-alt')) {
            el.setAttribute('alt', el.getAttribute('data-original-alt'));
            el.removeAttribute('data-original-alt');
          }
        });
      };
      
      // Apply theme
      const setTheme = (theme) => {
        if (theme === 'dark') {
          document.documentElement.classList.add('theme-dark');
          themeIcon.textContent = '☀️';
          disableTooltips();
        } else {
          document.documentElement.classList.remove('theme-dark');
          themeIcon.textContent = '🌙';
          enableTooltips();
        }
        localStorage.setItem('theme', theme);
      };
      
      // Initialize theme
      setTheme(getTheme());
      
      // Toggle theme
      themeToggle.addEventListener('click', () => {
        const currentTheme = getTheme();
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        setTheme(newTheme);
      });
      
      // Listen for system preference changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) {
          setTheme(e.matches ? 'dark' : 'light');
        }
      });
    });
  </script>
</head>
